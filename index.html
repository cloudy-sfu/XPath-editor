<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>XPath Evaluator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
            integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
            integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
            crossorigin="anonymous"></script>
    <!-- Code mirror -->
    <script src="./codemirror/codemirror.js"></script>
    <link rel="stylesheet" href="./codemirror/codemirror.css" />
    <script src="./codemirror/xml.js"></script>
    <!-- The following stylesheet is used, even if IDE doesn't recognize the usage. -->
    <style>.codemirror-read-only {background-color: #f5f5f5;}</style>
</head>
<body class="container-md">
<div class="row alert mb-0"><h5 class="card-title text-center">XPath Evaluator</h5> </div>
<div class="row alert">
    <div class="col-md-6">
        <label for="xpath-editor" class="form-label">XPath</label>
        <textarea id="xpath-editor"></textarea>
        <script>
            const xpath_editor = CodeMirror.fromTextArea(document.getElementById("xpath-editor"), {
                mode: "xml",
                theme: "default",
                lineWrapping: true,
                lineNumbers: false,
            });
            xpath_editor.setSize(null, xpath_editor.defaultTextHeight() * 2.5);  // 5 lines height (+0.5)
        </script>
        <p class="mt-4">XML sources</p>
        <nav>
            <div class="nav nav-tabs" role="tablist">
                <button class="nav-link active" id="xml-source-1-tab" data-bs-toggle="tab" data-bs-target="#xml-source-1"
                        type="button" role="tab" aria-controls="xml-source-1" aria-selected="true">Text area</button>
                <button class="nav-link" id="xml-source-2-tab" data-bs-toggle="tab" data-bs-target="#xml-source-2"
                        type="button" role="tab" aria-controls="xml-source-2" aria-selected="false">XML file</button>
            </div>
        </nav>
        <div class="tab-content mt-2">
            <div class="tab-pane fade show active" id="xml-source-1" role="tabpanel" aria-labelledby="xml-source-1-tab">
                <label for="xml-editor-in" class="form-label">Input the XML text</label>
                <textarea id="xml-editor-in" rows="10"></textarea>
                <script>
                    const xml_in_editor = CodeMirror.fromTextArea(document.getElementById("xml-editor-in"), {
                        mode: "xml",
                        lineNumbers: true,
                        theme: "default",
                    });
                    xml_in_editor.setSize(null, xml_in_editor.defaultTextHeight() * 14.5);
                </script>
                <div class="alert text-center">
                    <button class="btn btn-outline-dark" onclick="evaluate_text_area()">Evaluate</button>
                </div>
            </div>
            <div class="tab-pane fade" id="xml-source-2" role="tabpanel" aria-labelledby="xml-source-2-tab">
                <p>Attach the XML file</p>
                <input class="link-dark rounded" id="xml-input-file" accept="text/xml" type="file" name="file" />
                <div class="alert text-center">
                    <button class="btn btn-outline-dark" onclick="evaluate_xml_file()">Evaluate</button>
                </div>
<!-- Limitation: In this version, if you upload a very large file and have evaluated
an XPath once, it will re-scan the file when you evaluate an XPath the second time.-->
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <label for="xml-editor-out" class="form-label">
            Retrieved XML nodes <i>(each line is one query result)</i>
        </label>
        <textarea id="xml-editor-out" rows="10"></textarea>
        <script>
            const xml_out_editor = CodeMirror.fromTextArea(document.getElementById("xml-editor-out"), {
                mode: "xml",
                lineNumbers: true,
                theme: "default",
                readOnly: true,
            });
            xml_out_editor.setSize(null, xml_out_editor.defaultTextHeight() * 25.5);
            xml_out_editor.display.wrapper.classList.add('codemirror-read-only');
        </script>
    </div>
    <script src="./script_1.js"></script>
</div>
</body>
</html>
